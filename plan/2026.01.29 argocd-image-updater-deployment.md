# ArgoCD Image Updater ë°°í¬ ê³„íš ë° êµ¬í˜„ ê²°ê³¼

**ì‘ì„±ì¼:** 2026-01-29
**ëŒ€ìƒ í”„ë¡œì íŠ¸:** profanity-filter-api
**ë°°í¬ ë°©ì‹:** ë¹…ë±… (Big Bang)
**ëª©í‘œ:** ë¦´ë¦¬ì¦ˆ íƒœê·¸ ê¸°ë°˜ ìë™ ë°°í¬ êµ¬í˜„
**ìƒíƒœ:** âœ… êµ¬í˜„ ì™„ë£Œ

---

## ğŸ“‹ ëª©ì°¨

1. [í˜„ì¬ ìƒíƒœ ë¶„ì„](#í˜„ì¬-ìƒíƒœ-ë¶„ì„)
2. [ëª©í‘œ ì•„í‚¤í…ì²˜](#ëª©í‘œ-ì•„í‚¤í…ì²˜)
3. [êµ¬í˜„ ê²°ê³¼](#êµ¬í˜„-ê²°ê³¼)
4. [ë³€ê²½ íŒŒì¼ ëª©ë¡](#ë³€ê²½-íŒŒì¼-ëª©ë¡)
5. [ì„¤ì •ê°’ ë° Secret](#ì„¤ì •ê°’-ë°-secret)
6. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê²½í—˜](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…-ê²½í—˜)
7. [ê²€ì¦ ê²°ê³¼](#ê²€ì¦-ê²°ê³¼)
8. [ë¡¤ë°± ë°©ì•ˆ](#ë¡¤ë°±-ë°©ì•ˆ)

---

## í˜„ì¬ ìƒíƒœ ë¶„ì„

### ì´ì „ ë°°í¬ êµ¬ì¡° (Before)
```yaml
ë ˆí¬ì§€í† ë¦¬: profanity-filter-api
ArgoCD Application:
  - ì†ŒìŠ¤: deploy ë¸Œëœì¹˜
  - Auto-sync: enabled
  - ì´ë¯¸ì§€: ghcr.io/whale0928/profanity-api:deploy-877aa7d (í•˜ë“œì½”ë”©)

ì›Œí¬í”Œë¡œìš°:
  - release.yaml: ë¡œê·¸ë§Œ ì¶œë ¥ (ì‹¤ì œ ë°°í¬ ì—†ìŒ)
  - build_and_health_check.yml: Docker ë¡œì»¬ í…ŒìŠ¤íŠ¸ë§Œ
```

### ë¬¸ì œì 
1. âŒ deploy ë¸Œëœì¹˜ ìˆ˜ë™ ê´€ë¦¬ í•„ìš”
2. âŒ ì´ë¯¸ì§€ íƒœê·¸ í•˜ë“œì½”ë”© (ìˆ˜ë™ ì—…ë°ì´íŠ¸)
3. âŒ ë¦´ë¦¬ì¦ˆ íƒœê·¸ ìƒì„± ì‹œ ë°°í¬ ìë™í™” ì—†ìŒ
4. âŒ main ë¸Œëœì¹˜ ì»¤ë°‹ë§ˆë‹¤ ë°°í¬ë˜ëŠ” êµ¬ì¡° ë¶ˆê°€ëŠ¥

---

## ëª©í‘œ ì•„í‚¤í…ì²˜

### ë°°í¬ í”Œë¡œìš° (êµ¬í˜„ ì™„ë£Œ)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Developer: docker push v1.2.3 (ë˜ëŠ” GitHub Release)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Zot Registry (Self-hosted)                                   â”‚
â”‚    â†’ docker-registry.bottle-note.com/profanity-api:v1.2.3       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ArgoCD Image Updater v1.0.2 (5ë¶„ ê°„ê²©)                       â”‚
â”‚    â†’ ImageUpdater CR ê¸°ë°˜ ì„¤ì • (v1.0.x ì‹ ê·œ ë°©ì‹)                â”‚
â”‚    â†’ Zot API í´ë§                                               â”‚
â”‚    â†’ v*.*.* íŒ¨í„´ íƒœê·¸ ë°œê²¬ (semver)                             â”‚
â”‚    â†’ ArgoCD Application íŒŒë¼ë¯¸í„° ì˜¤ë²„ë¼ì´ë“œ                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ArgoCD Application (profanity-filter)                        â”‚
â”‚    â†’ Source: main ë¸Œëœì¹˜                                        â”‚
â”‚    â†’ Auto-sync: enabled                                         â”‚
â”‚    â†’ ì´ë¯¸ì§€ íŒŒë¼ë¯¸í„° ë³€ê²½ ê°ì§€ â†’ Rolling Update                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Kubernetes Cluster (profanity-production)                    â”‚
â”‚    â†’ Pod Rolling Update                                         â”‚
â”‚    â†’ ìƒˆ ì´ë¯¸ì§€ v1.2.3 ì ìš© ì™„ë£Œ                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°°í¬ íŠ¸ë¦¬ê±° ì •ì±…
| ì´ë²¤íŠ¸ | ArgoCD ë™ì‘ |
|--------|-----------|
| main ë¸Œëœì¹˜ ì½”ë“œ ì»¤ë°‹ | âŒ ë°°í¬ ì•ˆë¨ (ì´ë¯¸ì§€ íƒœê·¸ ë™ì¼) |
| main ë¸Œëœì¹˜ manifest ë³€ê²½ | âœ… ì¦‰ì‹œ ë°°í¬ (ConfigMap, Service ë“±) |
| Release v*.*.* íƒœê·¸ ìƒì„± | âœ… ì´ë¯¸ì§€ ë¹Œë“œ â†’ Image Updater ê°ì§€ â†’ ë°°í¬ |
| ìˆ˜ë™ ì´ë¯¸ì§€ í‘¸ì‹œ | âœ… Image Updater ê°ì§€ â†’ ë°°í¬ (5ë¶„ ì´ë‚´) |

---

## êµ¬í˜„ ê²°ê³¼

### ì£¼ìš” ë³€ê²½ì‚¬í•­ (v0.x â†’ v1.0.x)

| í•­ëª© | v0.x (ì´ì „ ê³„íš) | v1.0.2 (ì‹¤ì œ êµ¬í˜„) |
|------|------------------|-------------------|
| ì„¤ì • ë°©ì‹ | Application Annotation | **ImageUpdater CR (CRD ê¸°ë°˜)** |
| CRD í•„ìš” | ë¶ˆí•„ìš” | **í•„ìˆ˜** |
| RBAC | ê¸°ë³¸ | **imageupdaters ê¶Œí•œ ì¶”ê°€ í•„ìš”** |
| ë ˆì§€ìŠ¤íŠ¸ë¦¬ | ghcr.io | **docker-registry.bottle-note.com (Zot)** |

### íŒŒì¼ êµ¬ì¡° (Platform)

```
k8s-platform/platform/image-manager/
â”œâ”€â”€ kustomization.yaml              # ë¦¬ì†ŒìŠ¤ í†µí•©
â”œâ”€â”€ 00-crd.yaml                     # âœ… ImageUpdater CRD (v1.0.x í•„ìˆ˜)
â”œâ”€â”€ 10-rbac.yaml                    # ServiceAccount, ClusterRole, ClusterRoleBinding
â”œâ”€â”€ 20-deployment.yaml              # Image Updater Deployment (v1.0.2)
â”œâ”€â”€ 30-configmap.yaml               # ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„¤ì •, ArgoCD ì—°ê²°
â”œâ”€â”€ 40-imageupdater.yaml            # âœ… ImageUpdater CR (ëŒ€ìƒ Application ì •ì˜)
â”œâ”€â”€ image-updater-secret.sops.yaml  # SOPS ì•”í˜¸í™” ì‹œí¬ë¦¿
â”œâ”€â”€ ksops-generator.yaml            # KSOPS ìƒì„±ê¸°
â””â”€â”€ README.md                       # ì‚¬ìš© ê°€ì´ë“œ
```

### í•µì‹¬ ì„¤ì •: ImageUpdater CR (40-imageupdater.yaml)

```yaml
apiVersion: argocd-image-updater.argoproj.io/v1alpha1
kind: ImageUpdater
metadata:
  name: default-updater
  namespace: argocd
spec:
  namespace: argocd

  commonUpdateSettings:
    updateStrategy: "semver"                          # Semantic Versioning
    allowTags: "regexp:^v[0-9]+\\.[0-9]+\\.[0-9]+$"   # v1.0.0 í˜•ì‹ë§Œ í—ˆìš©
    ignoreTags:
      - "latest"
      - "dev"
      - "test"
      - "snapshot"

  writeBackConfig:
    method: "argocd"    # Git ìˆ˜ì • ì—†ì´ ArgoCD íŒŒë¼ë¯¸í„° ì˜¤ë²„ë¼ì´ë“œ

  applicationRefs:
    - namePattern: "profanity-filter"
      images:
        - alias: "profanity-api"
          imageName: "docker-registry.bottle-note.com/profanity-api"  # âš ï¸ íƒœê·¸ ì—†ì´!
          manifestTargets:
            kustomize:
              name: "docker-registry.bottle-note.com/profanity-api"
```

> **ì¤‘ìš”:** `imageName`ì— íƒœê·¸ë¥¼ í¬í•¨í•˜ë©´ í•´ë‹¹ íƒœê·¸ë§Œ í—ˆìš©ë˜ì–´ ì—…ë°ì´íŠ¸ê°€ ì•ˆ ë¨!

---

## ë³€ê²½ íŒŒì¼ ëª©ë¡

### k8s-platform ì €ì¥ì†Œ

```
âœ… ì‹ ê·œ ìƒì„±:
  platform/image-manager/00-crd.yaml           # ImageUpdater CRD
  platform/image-manager/40-imageupdater.yaml  # ImageUpdater CR
  platform/image-manager/README.md             # í•œê¸€ ì‚¬ìš© ê°€ì´ë“œ

âœ… ìˆ˜ì •:
  platform/image-manager/10-rbac.yaml          # imageupdaters ê¶Œí•œ ì¶”ê°€
  platform/image-manager/20-deployment.yaml    # loglevel=debug ì„¤ì •
  platform/image-manager/30-configmap.yaml     # Zot ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„¤ì •
  platform/image-manager/kustomization.yaml    # 00-crd, 40-imageupdater ì¶”ê°€
```

### profanity-filter-api ì €ì¥ì†Œ

```
âœ… ìˆ˜ì •:
  deploy/application.yaml
    - targetRevision: deploy â†’ main

  deploy/overlays/production/kustomization.yaml
    - images í•„ë“œ ì¶”ê°€:
      images:
        - name: docker-registry.bottle-note.com/profanity-api
          newTag: v0.0.1

  deploy/overlays/production/deployment.yaml
    - image: ghcr.io â†’ docker-registry.bottle-note.com
    - imagePullSecrets ì¶”ê°€: zot-registry-secret
```

---

## ì„¤ì •ê°’ ë° Secret

### ArgoCD Image Updater ì„¤ì •

| ì„¤ì • | ê°’ | ì„¤ëª… |
|------|---|------|
| `interval` | `5m` | ë ˆì§€ìŠ¤íŠ¸ë¦¬ í´ë§ ê°„ê²© |
| `loglevel` | `debug` | ë””ë²„ê¹…ìš© (ìš´ì˜ì‹œ info) |
| `argocd.server_addr` | `argocd-server.argocd` | ArgoCD ì„œë²„ ì£¼ì†Œ |
| `registries.prefix` | `docker-registry.bottle-note.com` | ë ˆì§€ìŠ¤íŠ¸ë¦¬ prefix |

### Secret ì„¤ì •

| Secret | ìœ„ì¹˜ | ìš©ë„ |
|--------|------|------|
| `argocd-image-updater-secret` | argocd namespace | ArgoCD í† í°, Zot ì¸ì¦ |
| `zot-registry-secret` | profanity-production namespace | Pod imagePullSecret |

### Secret ìƒì„± ëª…ë ¹

```bash
# Image Updaterìš© (argocd namespace) - SOPSë¡œ ê´€ë¦¬ë¨

# Pod imagePullìš© (ê° namespaceì— í•„ìš”)
kubectl create secret docker-registry zot-registry-secret \
  --docker-server=docker-registry.bottle-note.com \
  --docker-username=<username> \
  --docker-password=<password> \
  -n profanity-production
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê²½í—˜

### 1. CrashLoopBackOff - CRD ë¯¸ì„¤ì¹˜

**ì¦ìƒ:**
```
no matches for kind "ImageUpdater" in version "argocd-image-updater.argoproj.io/v1alpha1"
```

**ì›ì¸:** v1.0.xëŠ” CRD ê¸°ë°˜ì´ë¯€ë¡œ CRDê°€ í•„ìˆ˜

**í•´ê²°:** `00-crd.yaml` ìƒì„± ë° kustomization.yamlì— ì¶”ê°€

### 2. RBAC Permission Denied

**ì¦ìƒ:**
```
cannot list resource "imageupdaters" in API group "argocd-image-updater.argoproj.io"
```

**í•´ê²°:** ClusterRoleì— imageupdaters ê¶Œí•œ ì¶”ê°€
```yaml
- apiGroups: ["argocd-image-updater.argoproj.io"]
  resources: ["imageupdaters", "imageupdaters/status"]
  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
```

### 3. ë ˆì§€ìŠ¤íŠ¸ë¦¬ íƒœê·¸ ì¡°íšŒ ì‹¤íŒ¨

**ì¦ìƒ:**
```
Could not get tags from registry: name unknown: repository name not known to registry
```

**ì›ì¸:** ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì¸ì¦ ì‹¤íŒ¨ ë˜ëŠ” ì´ë¯¸ì§€ ë¯¸ì¡´ì¬

**í•´ê²°:**
1. Secretì˜ `zot.credentials` í˜•ì‹ í™•ì¸ (`username:password`)
2. ConfigMapì˜ `credentials: env:ZOT_CREDENTIALS` í™•ì¸
3. Deploymentì˜ í™˜ê²½ë³€ìˆ˜ ë§¤í•‘ í™•ì¸
4. Image Updater Pod ì¬ì‹œì‘

### 4. ìƒˆ ë²„ì „ ê°ì§€ ì•ˆë¨ (images_updated=0)

**ì¦ìƒ:**
```
Using version constraint 'v0.0.1' when looking for a new tag
found 1 from 2 tags eligible for consideration
Image already on latest allowed version
```

**ì›ì¸:** ImageUpdater CRì˜ `imageName`ì— íƒœê·¸ í¬í•¨ë¨

**í•´ê²°:**
```yaml
# âŒ ì˜ëª»ëœ ì„¤ì • (íƒœê·¸ í¬í•¨)
imageName: "docker-registry.bottle-note.com/profanity-api:v0.0.1"

# âœ… ì˜¬ë°”ë¥¸ ì„¤ì • (íƒœê·¸ ì—†ì´)
imageName: "docker-registry.bottle-note.com/profanity-api"
```

### 5. Pod ImagePullBackOff

**ì¦ìƒ:**
```
Failed to pull image: authorization failed: no basic auth credentials
```

**ì›ì¸:** K8s ë…¸ë“œì—ì„œ private ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì¸ì¦ í•„ìš”

**í•´ê²°:**
1. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— imagePullSecret ìƒì„±
2. Deploymentì— `imagePullSecrets` ì¶”ê°€

---

## ê²€ì¦ ê²°ê³¼

### ìë™ ë°°í¬ í…ŒìŠ¤íŠ¸ âœ… ì„±ê³µ

| í…ŒìŠ¤íŠ¸ | ê²°ê³¼ | ì†Œìš”ì‹œê°„ |
|--------|------|----------|
| v0.0.1 â†’ v0.0.2 | âœ… ìë™ ê°ì§€ ë° ë°°í¬ | ~5ë¶„ |
| v0.0.2 â†’ v0.0.3 | âœ… ìë™ ê°ì§€ ë° ë°°í¬ | ~5ë¶„ |

### Image Updater ë¡œê·¸ (ì„±ê³µ ì¼€ì´ìŠ¤)

```
level=debug msg="Using no version constraint when looking for a new tag"
level=debug msg="found 3 from 3 tags eligible for consideration"
level=info msg="Setting new image to docker-registry.bottle-note.com/profanity-api:v0.0.3"
level=info msg="Successfully updated image 'v0.0.2' to 'v0.0.3'"
level=info msg="Successfully updated application spec for profanity-filter"
level=info msg="Processing results: applications=1 images_updated=1 errors=0"
```

### ë°°í¬ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸

#### ì‹œë‚˜ë¦¬ì˜¤ A: ì´ë¯¸ì§€ íƒœê·¸ í‘¸ì‹œ â†’ ìë™ ë°°í¬ âœ…
```bash
# 1. ì´ë¯¸ì§€ í‘¸ì‹œ
docker push docker-registry.bottle-note.com/profanity-api:v0.0.3

# 2. 5ë¶„ ì´ë‚´ ìë™ ê°ì§€ ë° ë°°í¬
# 3. Pod Rolling Update ì§„í–‰
# 4. ìƒˆ ì´ë¯¸ì§€ ì ìš© ì™„ë£Œ
```

#### ì‹œë‚˜ë¦¬ì˜¤ B: manifest ë³€ê²½ â†’ ì¦‰ì‹œ ë°°í¬ âœ…
```bash
# 1. deployment.yaml ìˆ˜ì • í›„ mainì— push
# 2. ArgoCD ì¦‰ì‹œ ë™ê¸°í™”
# 3. ë³€ê²½ì‚¬í•­ ì ìš©
```

#### ì‹œë‚˜ë¦¬ì˜¤ C: ì½”ë“œ ì»¤ë°‹ â†’ ë°°í¬ ì•ˆë¨ âœ…
```bash
# 1. ì†ŒìŠ¤ ì½”ë“œ ìˆ˜ì • í›„ mainì— push (manifest ë³€ê²½ ì—†ìŒ)
# 2. ArgoCD Sync ì•ˆë¨ (ì´ë¯¸ì§€ íƒœê·¸ ë™ì¼)
# 3. Pod ì¬ì‹œì‘ ì—†ìŒ
```

---

## ë¡¤ë°± ë°©ì•ˆ

### ê¸´ê¸‰ ë¡¤ë°± (Image Manager ë¬¸ì œ ë°œìƒ ì‹œ)

```bash
# 1. Image Updater Deployment ìŠ¤ì¼€ì¼ ë‹¤ìš´
kubectl scale deployment -n argocd argocd-image-updater --replicas=0

# 2. ì´ì „ ì´ë¯¸ì§€ íƒœê·¸ë¡œ ìˆ˜ë™ ë°°í¬
kubectl set image deployment/profanity-api -n profanity-production \
  profanity-api=docker-registry.bottle-note.com/profanity-api:v0.0.2
```

### ì´ë¯¸ì§€ ë²„ì „ ë¡¤ë°±

```bash
# ë°©ë²• 1: ì§ì ‘ ì´ë¯¸ì§€ ë³€ê²½
kubectl set image deployment/profanity-api -n profanity-production \
  profanity-api=docker-registry.bottle-note.com/profanity-api:v0.0.1

# ë°©ë²• 2: ArgoCD Application íŒŒë¼ë¯¸í„° ì˜¤ë²„ë¼ì´ë“œ
argocd app set profanity-filter \
  -p kustomize.images[0].newTag=v0.0.1 \
  --grpc-web
```

---

## ì²´í¬ë¦¬ìŠ¤íŠ¸ (ì™„ë£Œ)

### Platform ì¤€ë¹„ âœ…
- [x] `platform/image-manager/00-crd.yaml` ìƒì„± (v1.0.x í•„ìˆ˜)
- [x] `platform/image-manager/10-rbac.yaml` imageupdaters ê¶Œí•œ ì¶”ê°€
- [x] `platform/image-manager/20-deployment.yaml` ì‘ì„±
- [x] `platform/image-manager/30-configmap.yaml` Zot ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„¤ì •
- [x] `platform/image-manager/40-imageupdater.yaml` ImageUpdater CR ì‘ì„±
- [x] `platform/image-manager/kustomization.yaml` ìˆ˜ì •
- [x] Git commit & push
- [x] ArgoCD ë°°í¬ í™•ì¸
- [x] Image Updater Pod ì •ìƒ ì‹¤í–‰ í™•ì¸

### Application ì¤€ë¹„ âœ…
- [x] `deploy/application.yaml` targetRevision: mainìœ¼ë¡œ ë³€ê²½
- [x] `deploy/overlays/production/kustomization.yaml` images í•„ë“œ ì¶”ê°€
- [x] `deploy/overlays/production/deployment.yaml` ì´ë¯¸ì§€ ê²½ë¡œ ë³€ê²½
- [x] `deploy/overlays/production/deployment.yaml` imagePullSecrets ì¶”ê°€
- [x] profanity-production namespaceì— zot-registry-secret ìƒì„±
- [x] Git commit & push to main
- [x] ArgoCD Application ì¬ë°°í¬ í™•ì¸

### ê²€ì¦ âœ…
- [x] v0.0.1 ì´ë¯¸ì§€ ë¹Œë“œ ë° í‘¸ì‹œ
- [x] Pod ì •ìƒ ì‹¤í–‰ í™•ì¸
- [x] v0.0.2 ì´ë¯¸ì§€ í‘¸ì‹œ â†’ ìë™ ë°°í¬ í™•ì¸
- [x] v0.0.3 ì´ë¯¸ì§€ í‘¸ì‹œ â†’ ìë™ ë°°í¬ í™•ì¸
- [x] Health check í†µê³¼ í™•ì¸

---

## í–¥í›„ ì‘ì—…

### GitHub Actions ì—°ë™ (ì„ íƒ)
- [ ] `.github/workflows/release.yaml` ìˆ˜ì •
- [ ] Release íƒœê·¸ ìƒì„± ì‹œ ìë™ ë¹Œë“œ ë° Zot í‘¸ì‹œ

### ë‹¤ë¥¸ Application ì ìš©
- [ ] bottle-note-api ImageUpdater CRì— ì¶”ê°€
- [ ] ê° namespaceì— zot-registry-secret ìƒì„±

---

## ì°¸ê³  ìë£Œ

- [ArgoCD Image Updater ê³µì‹ ë¬¸ì„œ](https://argocd-image-updater.readthedocs.io/)
- [v1.0.x CRD ê¸°ë°˜ ì„¤ì •](https://argocd-image-updater.readthedocs.io/en/stable/configuration/images/)
- [ìƒì„¸ êµ¬í˜„ ë…¸íŠ¸](/Users/hgkim/Documents/sync/í”„ë¡œì íŠ¸/homeLab/í™ˆ k3s argocd image updater êµ¬í˜„ ì ìš©.md)

---

**ì‘ì„±ì:** Claude
**ìµœì¢… ìˆ˜ì •:** 2026-01-29 17:25 KST
**ìƒíƒœ:** âœ… êµ¬í˜„ ì™„ë£Œ ë° ê²€ì¦ ì™„ë£Œ
